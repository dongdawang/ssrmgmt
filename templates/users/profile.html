{% load staticfiles %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>个人信息</title>
    <link rel="shortcut icon" href="{% static 'image/favicon.ico' %}" type="image/x-ico">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js">
    </script>
</head>
<body>
<div>
    <form enctype="multipart/form-data" action="{% url 'users:profile-photo' %}" method="post">
        <img name="profile_photo" src="{{ MEDIA_URL }}{{ request.user.profile_photo }}"
             hight="80" width="80" alt="头像显示"><br>
        修改头像:<input type="file" name="profile_photo"><br>
        {% csrf_token %}
        <input type="submit" value="提交头像修改">
    </form>
    <br>
    <br>
    <form action="{% url 'users:modify-pwd' %}" method="post">
        输入密码:<input type="text" name="password1"><br>
        再次确认:<input type="text" name="password2"><br>
        <input type="submit" value="确认修改">
        {% csrf_token %}
    </form>
    <br>
    <br>
    <br>
    <form enctype="multipart/form-data">
        {#    <input type="file" name="profile_photo">#}
        {#    <input type="submit" value="提交">#}
        username:<input name="username" value="{{ request.user.username }}" readonly="readonly"><br>
        {#    password:<p>{{ request.user.password }}</p>#}
        email:<input name="email" value="{{ request.user.email }}" readonly="readonly"><br>
        nick:<input name="nick_name" value="{{ request.user.nick_name }}"><br>
        gender:male:<input type="radio" name="gender" value="male"
            {% if request.user.gender == 'male' %}
                           checked="checked"
            {% endif %}>
        female:<input type="radio" name="gender" value="female" {% if request.user.gender == 'female' %}
                      checked="checked"
    {% endif %}>

    </form>
    <br>
    <br>
    <br>
    <form action="{% url 'users:modify-email' %}" method="post">
        <input type="text" id="email" name="email" value=""><br>
        <input type="text" id="code" name="code"><input type="button" value="发送验证码" onclick="send_email()"><br>
        <p>{{ email_status }}</p>
        <input type="submit" value="修改邮箱">
        {% csrf_token %}
    </form>
</div>
<script language="JavaScript">
    function send_email() {
        var params = {
            "email": $("#email").val(),
            "csrfmiddlewaretoken": $("input[name='csrfmiddlewaretoken']").val(),
        };
        alert(params.email);
        $.ajax({
            type: "POST",
            url: "{% url 'users:send_mail' %}",
            data: params,
            dataType : "json",
            success: function (respMsg) {
            }
        });
    }

    function test() {
        var v = $('#email').val();
        alert(v)
    }
</script>
</body>
</html>